import{b as O,u as R,r as l,j as e,l as _,K as A,O as B,V as F,L as v,z as w}from"./vendor-sH-yV7sT.js";import{u as P,a as $}from"./index-CUPUJmJk.js";import{A as D,m as a,F as N}from"./FieldIcon-IVW3Tmbp.js";const o={hidden:{y:10,opacity:0},show:(n=0)=>({y:0,opacity:1,transition:{delay:.04+n*.05,type:"spring",stiffness:160,damping:18}})};function W(){const n=O(),y=R(),{login:m}=P()||{},[i,k]=l.useState(localStorage.getItem("remember_email")||""),[c,S]=l.useState(""),[d,L]=l.useState(!1),[x,C]=l.useState(!!localStorage.getItem("remember_email")),[h,p]=l.useState(!1),[r,E]=l.useState({}),u=()=>{const s={};return/^\S+@\S+\.\S+$/.test(i)||(s.email="Enter a valid email"),c.length<6&&(s.password="Min 6 chars"),E(s),Object.keys(s).length===0},I=async s=>{var b,g,f;if(s.preventDefault(),!!u())try{p(!0);const{data:t}=await $.post("/api/auth/login",{email:i,password:c});localStorage.setItem("token",t.token),m==null||m({token:t.token,user:t.user}),x?localStorage.setItem("remember_email",i):localStorage.removeItem("remember_email"),w.success("Welcome back!");const j=new URLSearchParams(y.search).get("next");if(j)return n(j,{replace:!0});const z=((b=t.user)==null?void 0:b.role)==="owner"?"/owner":"/dashboard";n(z,{replace:!0})}catch(t){w.error(((f=(g=t==null?void 0:t.response)==null?void 0:g.data)==null?void 0:f.message)||"Invalid credentials")}finally{p(!1)}};return e.jsx(D,{heroTitle:"Welcome Back!",heroCopy:"Jump back in and pick up where you left off.",title:"Login",subtitle:e.jsxs("span",{children:["Don’t have an account?"," ",e.jsx(v,{to:"/register",className:"text-brand-700 dark:text-brand-400 hover:underline",children:"Create your account"})]}),children:e.jsxs(a.form,{className:"auth-form space-y-3",onSubmit:I,initial:"hidden",animate:"show",children:[e.jsxs(a.div,{className:"field",variants:o,custom:0,children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{className:`input pl-12 ${r.email?"border-red-400 focus:ring-red-400 focus:border-red-400":""}`,type:"email",value:i,onChange:s=>k(s.target.value),placeholder:"you@example.com",onBlur:u,autoComplete:"email"}),e.jsx(N,{show:!i,children:e.jsx(_,{className:"h-5 w-5"})})]}),r.email&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:r.email})]}),e.jsxs(a.div,{className:"field",variants:o,custom:1,children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{className:`input pr-10 pl-12 ${r.password?"border-red-400 focus:ring-red-400 focus:border-red-400":""}`,type:d?"text":"password",value:c,onChange:s=>S(s.target.value),placeholder:"••••••••",onBlur:u,autoComplete:"current-password"}),e.jsx(N,{show:!c,children:e.jsx(A,{className:"h-5 w-5"})}),e.jsx("button",{type:"button",className:"absolute right-2 top-2.5 text-slate-500 hover:text-slate-300",onClick:()=>L(s=>!s),"aria-label":d?"Hide password":"Show password",children:d?e.jsx(B,{size:18}):e.jsx(F,{size:18})})]}),r.password&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:r.password}),e.jsx("div",{className:"text-right mt-2",children:e.jsx(v,{to:"/forgot",className:"text-sm text-indigo-600 dark:text-indigo-400 hover:underline",children:"Forgot password?"})})]}),e.jsx(a.div,{className:"field flex items-center justify-between",variants:o,custom:2,children:e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",className:"accent-brand-600",checked:x,onChange:s=>C(s.target.checked)}),"Remember me"]})}),e.jsx(a.button,{type:"submit",className:"btn btn-primary w-full h-11",disabled:h,variants:o,custom:3,children:h?"Signing in…":"Login"}),e.jsxs("div",{className:"auth-social",children:[e.jsxs(a.div,{className:"flex items-center gap-3 text-xs text-slate-500 mt-3",variants:o,custom:4,children:[e.jsx("div",{className:"h-px flex-1 bg-slate-200 dark:bg-slate-800"}),"Or continue with",e.jsx("div",{className:"h-px flex-1 bg-slate-200 dark:bg-slate-800"})]}),e.jsxs(a.div,{className:"grid grid-cols-2 gap-3 mt-3",variants:o,custom:5,children:[e.jsx("button",{type:"button",disabled:!0,className:"btn w-full",children:"Google"}),e.jsx("button",{type:"button",disabled:!0,className:"btn w-full",children:"GitHub"})]})]})]})})}export{W as default};
